scripts:
  build:
    default: nps build.prepare && concurrently 'nps build.config' 'nps build.markup' 'nps build.style' 'nps build.assets'
    prepare: mkdirp 'build' 'build/zenplayer'
    config:
      default: concurrently 'nps build.config.robots' 'nps build.config.htaccess'
      robots: cp -R 'web/main/robots/' 'build'
      htaccess: cat 'web/main/.htaccess' 'node_modules/apache-server-configs/dist/.htaccess' >'build/.htaccess'
    markup:
      default: concurrently 'nps build.markup.index' 'nps build.markup.error' 'nps build.markup.zenplayer'
      index: mustache -p 'web/main/markup/head.html.mustache' 'web/main/data/index.json' 'web/main/markup/index.html.mustache' >'build/index.html'
      error: mustache -p 'web/main/markup/head.html.mustache' 'web/main/data/error.json' 'web/main/markup/error.html.mustache' >'build/error.html'
      zenplayer: mustache -p 'web/main/markup/head.html.mustache' 'web/main/data/zenplayer.json' 'web/main/markup/zenplayer.html.mustache' >'build/zenplayer/index.html'
    style:
      default: nps build.style.scss build.style.prefix
      scss: node-sass 'web/main/style' --include-path 'node_modules' --linefeed lf --output-style expanded --output 'build/css'
      prefix: postcss 'build/css' --use autoprefixer --no-map --replace
    assets:
      default: concurrently 'nps build.assets.images' 'nps build.assets.favicon'
      images: cp -R 'web/main/images/' 'build/images'
      favicon: cp -R 'web/main/favicon/' 'build'

  clean:
    default: rimraf 'build' 'dist'
